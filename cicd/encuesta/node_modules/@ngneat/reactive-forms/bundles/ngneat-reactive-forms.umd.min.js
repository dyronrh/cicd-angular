!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/forms"),require("rxjs"),require("rxjs/operators"),require("@angular/core")):"function"==typeof define&&define.amd?define("@ngneat/reactive-forms",["exports","@angular/forms","rxjs","rxjs/operators","@angular/core"],r):r(((t="undefined"!=typeof globalThis?globalThis:t||self).ngneat=t.ngneat||{},t.ngneat["reactive-forms"]={}),t.ng.forms,t.rxjs,t.rxjs.operators,t.ng.core)}(this,(function(t,r,e,o,n){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var i=function(t,r){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])})(t,r)};function a(t,r){function e(){this.constructor=t}i(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}Object.create;function s(t,r){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var o,n,i=e.call(t),a=[];try{for(;(void 0===r||r-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(n)throw n.error}}return a}function u(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(s(arguments[r]));return t}Object.create;function p(t){return Array.isArray(t)?t:[t]}function c(t){return null==t}function l(t){return e.isObservable(t)||function(t){return"function"==typeof(null==t?void 0:t.then)}(t)?e.from(t):e.of(t)}function y(t,r){return t||r?Object.assign(Object.assign({},t),r):null}function h(t,r){if(!t)return null;var e=Object.assign({},t);return delete e[r],Object.keys(e).length>0?e:null}function f(t){return t.getRawValue?t.getRawValue():t.value}function d(t){return e.merge(e.defer((function(){return e.of(f(t))})),t.valueChanges.pipe(o.map((function(){return f(t)}))))}function g(t){return e.merge(e.defer((function(){return e.of(t.disabled)})),t.statusChanges.pipe(o.map((function(){return t.disabled})),o.distinctUntilChanged()))}function b(t){return e.merge(e.defer((function(){return e.of(t.enabled)})),t.statusChanges.pipe(o.map((function(){return t.enabled})),o.distinctUntilChanged()))}function v(t){return e.merge(e.defer((function(){return e.of(t.status)})),t.statusChanges.pipe(o.map((function(){return t.status})),o.distinctUntilChanged()))}function m(t,r){return e.merge(e.defer((function(){return e.of(t.errors)})),r,t.valueChanges.pipe(o.map((function(){return t.errors})),o.distinctUntilChanged((function(t,r){return function(t,r){return c(t)||c(r)?t===r:JSON.stringify(t)===JSON.stringify(r)}(t,r)}))))}function V(t,r,e){r?t.enable(e):t.disable(e)}function A(t,r,e){V(t,!r,e)}function C(t,r,e){return r.subscribe((function(r){return A(t,r,e)}))}function O(t,r,e){return r.subscribe((function(r){return V(t,r,e)}))}function E(t,r){t.setValidators(u([t.validator],p(r))),t.updateValueAndValidity()}function j(t,r){return r.subscribe((function(r){t.setErrors(r)}))}function S(t,r,e){return t.hasError(r,e&&0!==e.length?e:void 0)&&t.touched}function k(t,r,e){return t.hasError(r,e&&0!==e.length?e:void 0)&&t.dirty}function w(t){t.markAsDirty({onlySelf:!0}),t._forEachChild((function(t){return t.markAllAsDirty()}))}var x=function(t){function r(r,n,i){var a=t.call(this,r,n,i)||this;return a.controls=r,a.touchChanges=new e.Subject,a.dirtyChanges=new e.Subject,a.errorsSubject=new e.Subject,a.touch$=a.touchChanges.asObservable().pipe(o.distinctUntilChanged()),a.dirty$=a.dirtyChanges.asObservable().pipe(o.distinctUntilChanged()),a.value$=d(a),a.disabled$=g(a),a.enabled$=b(a),a.status$=v(a),a.errors$=m(a,a.errorsSubject.asObservable()),a}return a(r,t),Object.defineProperty(r.prototype,"asyncValidator",{get:function(){return t.prototype.asyncValidator},set:function(r){t.prototype.asyncValidator=r},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"validator",{get:function(){return t.prototype.validator},set:function(r){t.prototype.validator=r},enumerable:!1,configurable:!0}),r.prototype.select=function(t){return this.value$.pipe(o.map(t),o.distinctUntilChanged())},r.prototype.getRawValue=function(){return t.prototype.getRawValue.call(this)},r.prototype.at=function(r){return t.prototype.at.call(this,r)},r.prototype.setValue=function(r,o){var n=this;if(e.isObservable(r))return r.subscribe((function(r){return t.prototype.setValue.call(n,r,o)}));t.prototype.setValue.call(this,r,o)},r.prototype.patchValue=function(r,o){var n=this;if(e.isObservable(r))return r.subscribe((function(r){return t.prototype.patchValue.call(n,r,o)}));t.prototype.patchValue.call(this,r,o)},r.prototype.push=function(r){return t.prototype.push.call(this,r)},r.prototype.insert=function(r,e){return t.prototype.insert.call(this,r,e)},r.prototype.setControl=function(r,e){return t.prototype.setControl.call(this,r,e)},r.prototype.disabledWhile=function(t,r){return C(this,t,r)},r.prototype.enabledWhile=function(t,r){return O(this,t,r)},r.prototype.mergeValidators=function(t){E(this,t)},r.prototype.mergeAsyncValidators=function(t){this.setAsyncValidators(u([this.asyncValidator],p(t))),this.updateValueAndValidity()},r.prototype.markAsTouched=function(r){t.prototype.markAsTouched.call(this,r),this.touchChanges.next(!0)},r.prototype.markAsUntouched=function(r){t.prototype.markAsUntouched.call(this,r),this.touchChanges.next(!1)},r.prototype.markAsPristine=function(r){t.prototype.markAsPristine.call(this,r),this.dirtyChanges.next(!1)},r.prototype.markAsDirty=function(r){t.prototype.markAsDirty.call(this,r),this.dirtyChanges.next(!0)},r.prototype.markAllAsDirty=function(){w(this)},r.prototype.reset=function(r,e){t.prototype.reset.call(this,r,e)},r.prototype.setValidators=function(r){t.prototype.setValidators.call(this,r),t.prototype.updateValueAndValidity.call(this)},r.prototype.setAsyncValidators=function(r){t.prototype.setAsyncValidators.call(this,r),t.prototype.updateValueAndValidity.call(this)},r.prototype.validateOn=function(t){var r=this;return t.subscribe((function(t){r.setErrors(t)}))},r.prototype.hasError=function(r,e){return t.prototype.hasError.call(this,r,e)},r.prototype.setErrors=function(r,e){return void 0===e&&(e={}),this.errorsSubject.next(r),t.prototype.setErrors.call(this,r,e)},r.prototype.mergeErrors=function(t,r){void 0===r&&(r={}),this.setErrors(y(this.errors,t),r)},r.prototype.removeError=function(t,r){void 0===r&&(r={}),this.setErrors(h(this.errors,t),r)},r.prototype.getError=function(r,e){return t.prototype.getError.call(this,r,e)},r.prototype.hasErrorAndTouched=function(t,r){return S(this,t,r)},r.prototype.hasErrorAndDirty=function(t,r){return k(this,t,r)},r.prototype.setEnable=function(t,r){void 0===t&&(t=!0),V(this,t,r)},r.prototype.setDisable=function(t,r){void 0===t&&(t=!0),A(this,t,r)},r.prototype.remove=function(t){this.removeWhen((function(r){return r.value===t}))},r.prototype.removeWhen=function(t){for(var r=this.length-1;r>=0;--r)t(this.at(r))&&this.removeAt(r)},r}(r.FormArray),$=function(t){function r(r,n,i){var a=t.call(this,r,n,i)||this;return a.touchChanges=new e.Subject,a.dirtyChanges=new e.Subject,a.errorsSubject=new e.Subject,a.touch$=a.touchChanges.asObservable().pipe(o.distinctUntilChanged()),a.dirty$=a.dirtyChanges.asObservable().pipe(o.distinctUntilChanged()),a.value$=d(a),a.disabled$=g(a),a.enabled$=b(a),a.status$=v(a),a.errors$=m(a,a.errorsSubject.asObservable()),a}return a(r,t),Object.defineProperty(r.prototype,"asyncValidator",{get:function(){return t.prototype.asyncValidator},set:function(r){t.prototype.asyncValidator=r},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"validator",{get:function(){return t.prototype.validator},set:function(r){t.prototype.validator=r},enumerable:!1,configurable:!0}),r.prototype.setValue=function(r,o){var n=this;if(e.isObservable(r))return r.subscribe((function(r){return t.prototype.setValue.call(n,r,o)}));t.prototype.setValue.call(this,r,o)},r.prototype.patchValue=function(r,o){var n=this;if(e.isObservable(r))return r.subscribe((function(r){return t.prototype.patchValue.call(n,r,o)}));t.prototype.patchValue.call(this,r,o)},r.prototype.disabledWhile=function(t,r){return C(this,t,r)},r.prototype.enabledWhile=function(t,r){return O(this,t,r)},r.prototype.mergeValidators=function(t){E(this,t)},r.prototype.mergeAsyncValidators=function(t){this.setAsyncValidators(u([this.asyncValidator],p(t))),this.updateValueAndValidity()},r.prototype.markAsTouched=function(r){t.prototype.markAsTouched.call(this,r),this.touchChanges.next(!0)},r.prototype.markAsUntouched=function(r){t.prototype.markAsUntouched.call(this,r),this.touchChanges.next(!1)},r.prototype.markAsPristine=function(r){t.prototype.markAsPristine.call(this,r),this.dirtyChanges.next(!1)},r.prototype.markAsDirty=function(r){t.prototype.markAsDirty.call(this,r),this.dirtyChanges.next(!0)},r.prototype.markAllAsDirty=function(){this.markAsDirty({onlySelf:!0})},r.prototype.reset=function(r,e){t.prototype.reset.call(this,r,e)},r.prototype.setValidators=function(r){t.prototype.setValidators.call(this,r),t.prototype.updateValueAndValidity.call(this)},r.prototype.setAsyncValidators=function(r){t.prototype.setAsyncValidators.call(this,r),t.prototype.updateValueAndValidity.call(this)},r.prototype.validateOn=function(t){return j(this,t)},r.prototype.getError=function(r){return t.prototype.getError.call(this,r)},r.prototype.hasError=function(r){return t.prototype.hasError.call(this,r)},r.prototype.setErrors=function(r,e){return void 0===e&&(e={}),this.errorsSubject.next(r),t.prototype.setErrors.call(this,r,e)},r.prototype.mergeErrors=function(t,r){void 0===r&&(r={}),this.setErrors(y(this.errors,t),r)},r.prototype.removeError=function(t,r){void 0===r&&(r={}),this.setErrors(h(this.errors,t),r)},r.prototype.hasErrorAndTouched=function(t){return S(this,t)},r.prototype.hasErrorAndDirty=function(t){return k(this,t)},r.prototype.setEnable=function(t,r){void 0===t&&(t=!0),V(this,t,r)},r.prototype.setDisable=function(t,r){void 0===t&&(t=!0),A(this,t,r)},r}(r.FormControl),D=function(){function t(){}return t.prototype.setValue=function(t,r){return localStorage.setItem(t,JSON.stringify(r)),r},t.prototype.getValue=function(t){return JSON.parse(localStorage.getItem(t)||"{}")},t}(),T=function(t){function n(r,n,i){var a=t.call(this,r,n,i)||this;return a.controls=r,a.touchChanges=new e.Subject,a.dirtyChanges=new e.Subject,a.errorsSubject=new e.Subject,a.touch$=a.touchChanges.asObservable().pipe(o.distinctUntilChanged()),a.dirty$=a.dirtyChanges.asObservable().pipe(o.distinctUntilChanged()),a.value$=d(a),a.disabled$=g(a),a.enabled$=b(a),a.status$=v(a),a.errors$=m(a,a.errorsSubject.asObservable()),a}return a(n,t),Object.defineProperty(n.prototype,"asyncValidator",{get:function(){return t.prototype.asyncValidator},set:function(r){t.prototype.asyncValidator=r},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"validator",{get:function(){return t.prototype.validator},set:function(r){t.prototype.validator=r},enumerable:!1,configurable:!0}),n.prototype.select=function(t){return function(t,r){return t.value$.pipe(o.map(r),o.distinctUntilChanged())}(this,t)},n.prototype.getRawValue=function(){return t.prototype.getRawValue.call(this)},n.prototype.get=function(r){return t.prototype.get.call(this,r)},n.prototype.getControl=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this.get(t.join("."))},n.prototype.addControl=function(r,e){t.prototype.addControl.call(this,r,e)},n.prototype.removeControl=function(r){t.prototype.removeControl.call(this,r)},n.prototype.contains=function(r){return t.prototype.contains.call(this,r)},n.prototype.setControl=function(r,e){t.prototype.setControl.call(this,r,e)},n.prototype.setValue=function(r,o){var n=this;if(e.isObservable(r))return r.subscribe((function(r){return t.prototype.setValue.call(n,r,o)}));t.prototype.setValue.call(this,r,o)},n.prototype.patchValue=function(r,o){var n=this;if(e.isObservable(r))return r.subscribe((function(r){return t.prototype.patchValue.call(n,r,o)}));t.prototype.patchValue.call(this,r,o)},n.prototype.disabledWhile=function(t,r){return C(this,t,r)},n.prototype.enabledWhile=function(t,r){return O(this,t,r)},n.prototype.mergeValidators=function(t){E(this,t)},n.prototype.mergeAsyncValidators=function(t){this.setAsyncValidators(u([this.asyncValidator],p(t))),this.updateValueAndValidity()},n.prototype.markAsTouched=function(r){t.prototype.markAsTouched.call(this,r),this.touchChanges.next(!0)},n.prototype.markAsUntouched=function(r){t.prototype.markAsUntouched.call(this,r),this.touchChanges.next(!1)},n.prototype.markAsPristine=function(r){t.prototype.markAsPristine.call(this,r),this.dirtyChanges.next(!1)},n.prototype.markAsDirty=function(r){t.prototype.markAsDirty.call(this,r),this.dirtyChanges.next(!0)},n.prototype.markAllAsDirty=function(){w(this)},n.prototype.reset=function(r,e){t.prototype.reset.call(this,r,e)},n.prototype.setValidators=function(r){t.prototype.setValidators.call(this,r),t.prototype.updateValueAndValidity.call(this)},n.prototype.setAsyncValidators=function(r){t.prototype.setAsyncValidators.call(this,r),t.prototype.updateValueAndValidity.call(this)},n.prototype.validateOn=function(t){return j(this,t)},n.prototype.hasError=function(r,e){return t.prototype.hasError.call(this,r,e)},n.prototype.setErrors=function(r,e){return void 0===e&&(e={}),this.errorsSubject.next(r),t.prototype.setErrors.call(this,r,e)},n.prototype.mergeErrors=function(t,r){void 0===r&&(r={}),this.setErrors(y(this.errors,t),r)},n.prototype.removeError=function(t,r){void 0===r&&(r={}),this.setErrors(h(this.errors,t),r)},n.prototype.getError=function(r,e){return t.prototype.getError.call(this,r,e)},n.prototype.hasErrorAndTouched=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return S.apply(void 0,u([this,t],r))},n.prototype.hasErrorAndDirty=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return k.apply(void 0,u([this,t],r))},n.prototype.setEnable=function(t,r){void 0===t&&(t=!0),V(this,t,r)},n.prototype.setDisable=function(t,r){void 0===t&&(t=!0),A(this,t,r)},n.prototype.persist=function(t,r){var e=this,n=r.debounceTime,i=r.manager,a=r.arrControlFactory,s=i||new D;return this.restore(t,s,a).pipe(o.switchMap((function(){return function(t,r,e){return t.valueChanges.pipe(o.debounceTime(e.debounceTime),o.switchMap((function(t){return l(e.manager.setValue(r,t))})))}(e,t,{debounceTime:n||250,manager:s})})))},n.prototype.restore=function(t,e,n){var i=this;return l(e.getValue(t)).pipe(o.take(1),o.tap((function(t){t&&(!function(t,e,o){Object.keys(e).forEach((function(n){var i=e[n];if(Array.isArray(i)&&t.get(n)instanceof r.FormArray){if(!o||o&&!(n in o))throw new Error("Please provide arrControlFactory for "+n);var a=t.get(n),s=o[n];!function(t){for(;0!==t.length;)t.removeAt(0)}(a),i.forEach((function(t,r){return a.insert(r,s(t))}))}}))}(i,t,n),i.patchValue(t,{emitEvent:!1}))})))},n}(r.FormGroup);var U=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),r.prototype.group=function(t,r){var e,o=this._reduceControls(t),n=null,i=null;return null!=r&&(!function(t){return void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn}(r)?(n=null!=r.validator?r.validator:null,i=null!=r.asyncValidator?r.asyncValidator:null):(n=null!=r.validators?r.validators:null,i=null!=r.asyncValidators?r.asyncValidators:null,e=null!=r.updateOn?r.updateOn:void 0)),new T(o,{asyncValidators:i,updateOn:e,validators:n})},r.prototype.control=function(t,r,e){return new $(t,r,e)},r.prototype.array=function(t,r,e){var o=this,n=t.map((function(t){return o._createControl(t)}));return new x(n,r,e)},r}(r.FormBuilder);U.ɵprov=n.ɵɵdefineInjectable({factory:function(){return new U},token:U,providedIn:"root"}),U.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}];var P=function(){function t(){this.onChange=function(t){},this.onTouched=function(){}}return t.prototype.registerOnChange=function(t){this.onChange=t},t.prototype.registerOnTouched=function(t){this.onTouched=t},t}(),_=function(){function t(){}return t.prototype.setValue=function(t,r){return sessionStorage.setItem(t,JSON.stringify(r)),r},t.prototype.getValue=function(t){return JSON.parse(sessionStorage.getItem(t)||"{}")},t}();t.ControlValueAccessor=P,t.FormArray=x,t.FormBuilder=U,t.FormControl=$,t.FormGroup=T,t.LocalStorageManager=D,t.SessionStorageManager=_,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngneat-reactive-forms.umd.min.js.map